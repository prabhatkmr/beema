# Development Dockerfile for Studio with Hot Reload

FROM node:22-alpine AS development

WORKDIR /app

# Install pnpm
RUN corepack enable && corepack prepare pnpm@latest --activate

# Copy workspace configuration
COPY package.json pnpm-workspace.yaml pnpm-lock.yaml* ./
COPY turbo.json ./

# Copy package files
COPY packages/ui/package.json ./packages/ui/
COPY apps/studio/package.json ./apps/studio/

# Install dependencies
RUN pnpm install --frozen-lockfile

# Copy source code (will be mounted as volume in dev mode)
COPY packages/ui ./packages/ui
COPY apps/studio ./apps/studio

# Expose Next.js dev server and debug port
EXPOSE 3000 9229

# Start Next.js in dev mode
CMD ["pnpm", "--filter", "@beema/studio", "dev"]
